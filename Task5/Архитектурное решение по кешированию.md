# Архитектурное решение по кешированию

## Мотивация

Внедрение кеширования позволит повысить производительноть системы и решить одну из текущих проблем пользователей – медленную загрузку страницы с заказами в MES.

## Предлагаемое решение

В качестве решения предлагается внедрить серверное кеширование – оно позволит снизить латентность запросов от клиентов, ускорив тем самым загрузку страницы в MES. Клиентское кеширование в контексте MES будет менее актуальным, поскольку оно не поспособствует более быстрому получению пользователями информации о новейших заказах. Более того, кеширование на клиенте приведем к тому, что операторы гарантированно будут получать устаревшие данные до инвалидации кеша, что является критичным в контексте текущего бизнес-процесса.

Для ускорения загрузки данных о заказах необходимо внедрить кеширование между сервисом MES API и базой данных MES DB. В качестве паттерна кеширования предлагается использовать паттерн read-through в виду преобладания операций чтения и его простоты.

Диаграмму последовательности действий можно найти [тут](https://editor.plantuml.com/uml/hLJBJiCm4BpxArRS-mCS47r4m051gNgkjicsM4hiO6_Au-ln9av8qaO8YKiSsxixC-knRpsZuwh85MlE2UOvVQ39d6Q29vUHWoMchzeSOKDl5PcKOANnwB1GgWoPEjKb6eR7P3EONuK5c3y_N05wsTo5_q60b2NPNCwNzudAa76Fdfh4rQBBMorKmAraWxp78y5Qfkt-PdwNxDRRP9iefIHrTjF2NSEBKFRiWGEKeVVm3rP4UJXOLwyUj0kBh0jIcB8-OT3TqesZbAn9Ia7CF0ZNd-Y6V_rjmLUBVYXuBMqJjBGMhJrGKVBd4348RGQOpMuwn0UZMMEklyZ_L50PZLCZlcJsv7FbJEJRIsaOT-fYpdHysuznVwVR-o-zlAYbT7JIjlBvPzEAxF_K6HjczXGitw564yEHE9ubxct58hOraWiov7eSd2q0eOWchJtRLptmQgiUWMsfq_DszHTw5X_C9ZhKSHY979OvEunubBN8gWn34FMhoRSIIEDJd7Rp2_dI6az-si7z6zJd91VsdDS8gWDgYVtzobmW65-e2vQv9PF9s_aD).

В качестве паттерна инвалидации кеша выберем паттерн на основе изменений – он позволит обновлять данные в кеше каждый раз, когда какой-либо заказ переходит в статус MANUFACTURING_APPROVED или MANUFACTURING_STARTED, сводя задержки минимуму.

| Паттерн             | Плюсы                                     | Минусы                                                         |
| ------------------- | ----------------------------------------- | -------------------------------------------------------------- |
| На основе запросов  | Незначительные задержки                   | Необходимость проверять актуальность кеша при каждом запросе   |
| На основе изменений | Отсутствие задержек, простота реализации  | -                                                              |
| Временная           | Простота реализации                       | Задержки                                                       |
| Программная         | Отсутствие задержек                       | Более трудоемкий в реализации, чем паттерн на основе изменений |
| По ключу            | Удобен при кешировании детализации заказа | Не удобен при кешировнии списка заказов                        |
