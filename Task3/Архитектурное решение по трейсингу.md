# Архитектурное решение по трейсингу

## Мотивация

Внедрение трейсинга позволит ускорить решение таких проблем пользователей, как неполучение заказов и низкая производительность. По мере усложнения системы трейсинг будет также упрощать локализацию и решение других проблем, что сэкономит время разработчиков и снизит репутационные риски.

Метрики, на которые повлияет внедрение трейсинга:

- латентность запросов, отправляемых от клиентов к системе – поскольку разработчики смогут лучше понимать, в каких местах микросервисной системы запросы обрабатываются долго, они смогут точечно оптимизировать проблемные сервисы;
- скорость обработки пользовательских заявок на поддержку – при возникновении проблем разработчикам будет легче их локализовывать, что позволит быстрее отвечать пользователям в случае их обращения;
- затраты на поддержку;
- удовлетворенность клиентов.

## Предлагаемое решение

Обновленную диаграмму контейнеров можно найти [тут](https://drive.google.com/file/d/1hy5X6D47CGnJVUyj7ssecM7UIrOsyaCz/view?usp=sharing) или в корне репозитория.

## Компромиссы

В идеальном случае данные о запросах должны поступать в систему трейсинга из всех сервисов, участвующих в оформлении заказов и их дальнейшей обработке. Тем не менее, в случае возникновения проблем или сложностей с добавлением сбора телеметрии в каком-либо из компонентов системы, например, в MES API, как в проприетарное программное обеспечение, стоит всегда в отдельном порядке оценивать трудозатраты на включение такого компонента в трейсинг. Даже если какие-то компоненты системы не будут отправлять телеметрию, трейсинг все равно будет полезен, так как даже в таком случае он будет давать больше понимания относительно того, где локализована проблема.

Если в будущем системе потребуется более полное покрытие трейсингом, добавление непокрытых компонентов может также обсуждаться в отдельном порядке.

## Аспекты безопасности

Для снижения связанных с безопасностью рисков при внедрении трейсинга необходимо:

- разграничить доступ к собираемым данным в Jaeger UI;
- маскировать чувствительные данные при хранении или, по возможности, вообще их не собирать;
- обеспечить безопасность при передаче данных между отслеживаемыми компонентами системы и инстансом Jaeger, например, с использованием шифрования;
- обеспечить безопасность запускаемого инстанса Jaeger, например, с помощью контейнеризации, а также настроить разграничение доступа на сервере, на котором он запускается;
